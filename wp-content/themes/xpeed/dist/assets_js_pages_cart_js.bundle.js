"use strict";
/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunkxpeed"] = self["webpackChunkxpeed"] || []).push([["assets_js_pages_cart_js"],{

/***/ "./assets/js/apiHandler.js":
/*!*********************************!*\
  !*** ./assets/js/apiHandler.js ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _loading_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./loading.js */ \"./assets/js/loading.js\");\n/* harmony import */ var _variable_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./variable.js */ \"./assets/js/variable.js\");\n/* provided dependency */ var $ = __webpack_require__(/*! jquery */ \"./node_modules/jquery/dist/jquery.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _classCallCheck(a, n) { if (!(a instanceof n)) throw new TypeError(\"Cannot call a class as a function\"); }\nfunction _defineProperties(e, r) { for (var t = 0; t < r.length; t++) { var o = r[t]; o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o); } }\nfunction _createClass(e, r, t) { return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", { writable: !1 }), e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\n\n\nvar APIHandler = /*#__PURE__*/function () {\n  function APIHandler() {\n    _classCallCheck(this, APIHandler);\n  }\n  return _createClass(APIHandler, null, [{\n    key: \"post\",\n    value: function post(url, data) {\n      var isLoading = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n      _loading_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].show(); // Hiển thị loading nếu isLoading là true\n      console.log('isLoading', isLoading);\n      return $.ajax({\n        url: this.buildUrl(url),\n        method: 'POST',\n        contentType: 'application/json',\n        data: JSON.stringify(data)\n      }).always(function () {\n        if (isLoading) _loading_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].hide(); // Ẩn loading sau khi hoàn thành call API\n      });\n    }\n  }, {\n    key: \"get\",\n    value: function get(url, data) {\n      var isLoading = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n      if (isLoading) _loading_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].show(); // Hiển thị loading nếu isLoading là true\n      return $.ajax({\n        url: this.buildUrl(url),\n        method: 'GET',\n        contentType: 'application/json',\n        data: JSON.stringify(data)\n      }).always(function () {\n        if (isLoading) _loading_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].hide(); // Ẩn loading sau khi hoàn thành call API\n      });\n    }\n  }, {\n    key: \"buildUrl\",\n    value: function buildUrl(url) {\n      url = _variable_js__WEBPACK_IMPORTED_MODULE_1__.BASE_URL + url; // Thay thế baseUrl bằng URL cơ bản của bạn\n\n      return url;\n    }\n  }]);\n}();\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (APIHandler);\n\n//# sourceURL=webpack://xpeed/./assets/js/apiHandler.js?");

/***/ }),

/***/ "./assets/js/loading.js":
/*!******************************!*\
  !*** ./assets/js/loading.js ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* provided dependency */ var $ = __webpack_require__(/*! jquery */ \"./node_modules/jquery/dist/jquery.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _classCallCheck(a, n) { if (!(a instanceof n)) throw new TypeError(\"Cannot call a class as a function\"); }\nfunction _defineProperties(e, r) { for (var t = 0; t < r.length; t++) { var o = r[t]; o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o); } }\nfunction _createClass(e, r, t) { return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", { writable: !1 }), e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nvar userLoading = /*#__PURE__*/function () {\n  function userLoading() {\n    _classCallCheck(this, userLoading);\n  }\n  return _createClass(userLoading, null, [{\n    key: \"show\",\n    value: function show() {\n      var loader = $('.wp-loading-overlay');\n      if (loader.length) {\n        loader.css('display', 'flex');\n      }\n      return true;\n    }\n  }, {\n    key: \"hide\",\n    value: function hide(url, data) {\n      var loader = $('.wp-loading-overlay');\n      if (loader.length) {\n        loader.css('display', 'none');\n      }\n      return false;\n    }\n  }]);\n}();\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (userLoading);\n\n//# sourceURL=webpack://xpeed/./assets/js/loading.js?");

/***/ }),

/***/ "./assets/js/pages/cart.js":
/*!*********************************!*\
  !*** ./assets/js/pages/cart.js ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _apiHandler_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../apiHandler.js */ \"./assets/js/apiHandler.js\");\n/* provided dependency */ var $ = __webpack_require__(/*! jquery */ \"./node_modules/jquery/dist/jquery.js\");\n\n$(document).ready(function () {\n  var isPayment = true;\n  // Hàm tính tổng tiền cho sản phẩm\n  function calculateTotalForItem($itemRow) {\n    var price = parseInt($itemRow.find('.cart__item-details-price').text().replace(/\\D/g, ''));\n    var quantity = parseInt($itemRow.find('.cart__item-quantity-input').val());\n    var total = price * quantity;\n    $itemRow.find('.cart__item-price').text(total.toLocaleString() + ' đ');\n    return total;\n  }\n\n  // Hàm tính tổng tiền toàn bộ giỏ hàng\n  function calculateTotalCart() {\n    var totalCarts = 0;\n    $('.cart__item').each(function () {\n      var totalItem = calculateTotalForItem($(this));\n      totalCarts += totalItem;\n    });\n    $('.cart__actions-total').text(totalCarts.toLocaleString() + ' đ');\n  }\n\n  // Sự kiện click nút giảm số lượng\n  $('.cart__item-quantity-decrease').on('click', function () {\n    var $quantityInput = $(this).closest('.cart__item').find('.cart__item-quantity-input');\n    var quantity = parseInt($quantityInput.val());\n    if (quantity > 1) {\n      quantity--;\n      $quantityInput.val(quantity);\n      isPayment = false;\n      calculateTotalCart(); // Cập nhật tổng tiền giỏ hàng\n    }\n  });\n\n  // Sự kiện click nút tăng số lượng\n  $('.cart__item-quantity-increase').on('click', function () {\n    var $itemRow = $(this).closest('.cart__item');\n    var $quantityInput = $itemRow.find('.cart__item-quantity-input');\n    var stockQuantity = parseInt($itemRow.find('.cart__item-stock-quantity').text()); // Lấy số lượng tồn kho\n    var quantity = parseInt($quantityInput.val());\n\n    // Kiểm tra số lượng hiện tại với số lượng tồn kho\n    if (quantity < stockQuantity) {\n      console.log('quantity', quantity);\n      quantity++;\n      $quantityInput.val(quantity);\n      isPayment = false;\n      calculateTotalCart(); // Cập nhật tổng tiền giỏ hàng\n    } else {\n      Swal.fire({\n        icon: \"error\",\n        title: \"Không thể thêm quá số lượng tồn kho.\",\n        showConfirmButton: false,\n        timer: 1500\n      });\n    }\n  });\n\n  // Sự kiện khi thay đổi trực tiếp số lượng trong input\n  $('.cart__item-quantity-input').on('input', function () {\n    var $itemRow = $(this).closest('.cart__item');\n    var stockQuantity = parseInt($itemRow.find('.cart__item-stock-quantity').text());\n    var quantity = parseInt($(this).val());\n    if (quantity && quantity > 0 && quantity <= stockQuantity) {\n      isPayment = false;\n      calculateTotalCart(); // Cập nhật tổng tiền giỏ hàng\n    } else {\n      // Nếu số lượng nhập vào lớn hơn tồn kho, đặt lại giá trị bằng tồn kho\n      $(this).val(stockQuantity);\n      calculateTotalCart();\n      Swal.fire({\n        icon: \"error\",\n        title: \"Số lượng không được vượt quá tồn kho.\",\n        showConfirmButton: false,\n        timer: 1500\n      });\n    }\n  });\n\n  // Cập nhật lại giỏ hàng ngay khi trang load\n  calculateTotalCart();\n  $('.button--primary-cart').on('click', function () {\n    var products = [];\n    $('.cart__item').each(function () {\n      var productId = $(this).data('product-id');\n      var quantity = $(this).find('.cart__item-quantity-input').val();\n      var variation = {\n        pa_size: $(this).find('.cart__item-size').data('variation-size') // Lấy kích thước từ data-attribute\n      };\n      products.push({\n        productId: productId,\n        quantity: quantity,\n        variation: variation\n      });\n    });\n    if (products) {\n      _apiHandler_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].post('/wp-json/custom-api/v1/update-cart', products).done(function (response) {\n        isPayment = true;\n        Swal.fire({\n          icon: \"success\",\n          title: \"Giỏ hàng đã được cập nhật!\",\n          showConfirmButton: false,\n          timer: 1500\n        });\n      }).fail(function (err) {\n        var _err$responseJSON$mes;\n        Swal.fire({\n          icon: \"error\",\n          title: (_err$responseJSON$mes = err.responseJSON.message) !== null && _err$responseJSON$mes !== void 0 ? _err$responseJSON$mes : \"Không thể thêm sản phẩm vào giỏ hàng. Vui lòng thử lại sau.\",\n          showConfirmButton: false,\n          timer: 3000\n        });\n      });\n    }\n  });\n  $('.cart__item-action-delete').on('click', function () {\n    var productId = $(this).closest('.cart__item').data('product-id');\n    var variationSize = $(this).closest('.cart__item').find('.cart__item-size').data('variation-size');\n    var $itemRow = $(this).closest('.cart__item'); // Dòng sản phẩm cần xóa\n    var variation = variationSize ? {\n      pa_size: variationSize\n    } : null;\n    var data = {\n      productId: productId,\n      variation: variation\n    };\n    _apiHandler_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].post('/wp-json/custom-api/v1/remove-cart-item', data).done(function (response) {\n      $itemRow.remove();\n      calculateTotalCart();\n    }).fail(function () {\n      Swal.fire({\n        icon: \"error\",\n        title: \"Xóa sản phẩm không thành công. Vui lòng thử lại.\",\n        showConfirmButton: false,\n        timer: 1500\n      });\n    });\n  });\n  $('#paymentBtn').on('click', function () {\n    // Lấy giá trị userId từ thuộc tính data-userID của nút\n    var userId = $(this).data('userid'); // Lấy giá trị từ data-userID của nút\n\n    if (!isPayment) {\n      Swal.fire({\n        icon: \"error\",\n        title: \"Cập nhật giỏ hàng trước khi thanh toán.\",\n        showConfirmButton: false,\n        timer: 3000\n      });\n    } else {\n      // Gửi request API với tham số userId\n      _apiHandler_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].get('/wp-json/custom-api/v1/order/create?userId=' + userId).done(function (response) {\n        var _response$orderId;\n        // Chuyển hướng tới trang thanh toán với orderId trả về\n        window.location.href = baseUrl + '/payment?id=' + ((_response$orderId = response.orderId) !== null && _response$orderId !== void 0 ? _response$orderId : '');\n      }).fail(function (error) {\n        var _error$responseJSON$m;\n        Swal.fire({\n          icon: \"error\",\n          title: (_error$responseJSON$m = error.responseJSON.message) !== null && _error$responseJSON$m !== void 0 ? _error$responseJSON$m : \"Thanh toán thất bại. Vui lòng thử lại.\",\n          showConfirmButton: false,\n          timer: 1500\n        }).then(function () {\n          window.location.href = window.location.href;\n        });\n      });\n    }\n  });\n  showAlertFromUrlParam('errorPayment');\n  function showAlertFromUrlParam(paramName) {\n    var urlParams = new URLSearchParams(window.location.search);\n    var message = urlParams.get(paramName);\n    if (message) {\n      Swal.fire({\n        icon: \"error\",\n        title: decodeURIComponent(message),\n        showConfirmButton: false,\n        timer: 1500\n      });\n    }\n  }\n});\n\n//# sourceURL=webpack://xpeed/./assets/js/pages/cart.js?");

/***/ }),

/***/ "./assets/js/variable.js":
/*!*******************************!*\
  !*** ./assets/js/variable.js ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BASE_URL: () => (/* binding */ BASE_URL)\n/* harmony export */ });\nvar BASE_URL = \"http://localhost/WEB-XPEED-BE\";\n\n//# sourceURL=webpack://xpeed/./assets/js/variable.js?");

/***/ })

}]);